{"version":3,"file":"gallery.js","sources":["../src/js/fetchimages.js","../src/js/searchimages.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '51131580-71d1bfd62f4d437a89cc3b2bc';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 40;\n\nexport async function fetchImagesWithAxios(query, page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        per_page: PER_PAGE,\n        page: page,\n      },\n    });\n\n    return {\n      hits: response.data.hits,\n      totalHits: response.data.totalHits,\n    };\n  } catch (error) {\n    console.error('API isteği sırasında bir hata oluştu:', error.message);\n\n    throw new Error('API isteği başarısız oldu.');\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { fetchImagesWithAxios } from './fetchimages';\n\n// DOM elementleri\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery-list');\nconst loader = document.querySelector('#loader');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\n// Durum (State) değişkenleri\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n\nconst lightbox = new SimpleLightbox('.gallery a');\n\n// Sayfa yüklendiğinde load more butonunu gizle\nhideLoadMoreBtn();\n\n// Loader yardımcı fonksiyonlar\nfunction showLoadingText() {\n  loader.classList.remove('hidden');\n}\n\nfunction hideLoadingText() {\n  loader.classList.add('hidden');\n}\n\n// -- OLAY DİNLEYİCİLERİ --\nform.addEventListener('submit', handleFormSubmit);\nloadMoreBtn.addEventListener('click', handleLoadMore);\n\nasync function handleFormSubmit(event) {\n  event.preventDefault();\n  const searchQuery = event.target.elements.searchQuery.value.trim();\n\n  if (!searchQuery) {\n    showToast('info', 'Arama alanı boş olamaz!');\n    return;\n  }\n\n  currentQuery = searchQuery;\n  currentPage = 1;\n  gallery.innerHTML = '';\n  hideLoadMoreBtn();\n  showLoader();\n\n  try {\n    const { hits, totalHits: apiTotalHits } = await fetchImagesWithAxios(\n      currentQuery,\n      currentPage\n    );\n    totalHits = apiTotalHits;\n\n    if (hits.length === 0) {\n      showToast(\n        'error',\n        'Üzgünüz, arama sorgunuza uygun görsel bulunamadı. Lütfen tekrar deneyin!'\n      );\n      return;\n    }\n\n    renderImages(hits);\n\n    if (totalHits > hits.length) {\n      showLoadMoreBtn();\n    }\n\n    checkEndOfCollection();\n  } catch (error) {\n    showToast('error', 'Bir hata oluştu. Lütfen daha sonra tekrar deneyin.');\n    console.error(error);\n  } finally {\n    hideLoader();\n  }\n}\n\nasync function handleLoadMore() {\n  currentPage += 1;\n  showLoader();\n  showLoadingText();\n  hideLoadMoreBtn();\n\n  try {\n    const { hits } = await fetchImagesWithAxios(currentQuery, currentPage);\n    renderImages(hits, false);\n    smoothScroll();\n    checkEndOfCollection();\n  } catch (error) {\n    showToast('error', 'Görseller yüklenirken bir hata oluştu.');\n    console.error(error);\n  } finally {\n    hideLoader();\n    hideLoadingText();\n  }\n}\n\nfunction renderImages(images, clear = true) {\n  const markup = images.map(createImageMarkup).join('');\n  if (clear) {\n    gallery.innerHTML = markup;\n  } else {\n    gallery.insertAdjacentHTML('beforeend', markup);\n  }\n  lightbox.refresh();\n}\n\nfunction createImageMarkup(img) {\n  return `\n    <li class=\"image-card\">\n      <a href=\"${img.largeImageURL}\">\n        <img src=\"${img.webformatURL}\" alt=\"${img.tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n          <p><b>Likes</b> ${img.likes}</p>\n          <p><b>Views</b> ${img.views}</p>\n          <p><b>Comments</b> ${img.comments}</p>\n          <p><b>Downloads</b> ${img.downloads}</p>\n        </div>\n      </a>\n    </li>\n  `;\n}\n\nfunction checkEndOfCollection() {\n  const currentImageCount = gallery.children.length;\n\n  if (currentImageCount >= totalHits) {\n    hideLoadMoreBtn();\n    if (totalHits > 0) {\n      showToast('info', 'Üzgünüz, arama sonuçlarının sonuna ulaştınız.');\n    }\n  } else {\n    showLoadMoreBtn();\n  }\n}\n\nfunction smoothScroll() {\n  const cardHeight = gallery.firstElementChild.getBoundingClientRect().height;\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction showLoader() {\n  loader.classList.remove('hidden');\n}\nfunction hideLoader() {\n  loader.classList.add('hidden');\n}\nfunction showLoadMoreBtn() {\n  loadMoreBtn.classList.remove('hidden');\n}\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.classList.add('hidden');\n}\n\nfunction showToast(type, message) {\n  iziToast[type]({\n    message: message,\n    position: 'topRight',\n    timeout: 3000,\n  });\n}\n"],"names":["API_KEY","BASE_URL","PER_PAGE","fetchImagesWithAxios","query","page","response","axios","error","form","gallery","loader","loadMoreBtn","currentPage","currentQuery","totalHits","lightbox","SimpleLightbox","hideLoadMoreBtn","showLoadingText","hideLoadingText","handleFormSubmit","handleLoadMore","event","searchQuery","showToast","showLoader","hits","apiTotalHits","renderImages","showLoadMoreBtn","checkEndOfCollection","hideLoader","smoothScroll","images","clear","markup","createImageMarkup","img","cardHeight","type","message","iziToast"],"mappings":"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"}